fit <- analyse(miceTable, "delta_ct_cewe")
source("Models/BCI_qPCR-NormalDistrib.R")
source("MLE_hybrid_functions.R")
source("/home/alice/Schreibtisch/git_projects/Parasite_load_local/Parasite_Load/R/Models/BCI_qPCR-NormalDistrib.R")
source("/home/alice/Schreibtisch/git_projects/Parasite_load_local/Parasite_Load/R/MLE_hybrid_functions.R")
qpcrData <- read.csv("https://raw.githubusercontent.com/derele/Mouse_Eimeria_Databasing/master/raw_data/Eimeria_detection/qPCR_2016.csv")
names(qpcrData)[1] <- "Mouse_ID"
miceTable <- read.csv("https://raw.githubusercontent.com/derele/Mouse_Eimeria_Databasing/master/raw_data/MiceTable_2014to2017.csv")
miceTable <- merge(miceTable, qpcrData)
miceTable$delta_ct_cewe <- miceTable$delta_ct_cewe + 5
miceTable$delta_ct_ilwe <- miceTable$delta_ct_ilwe + 5
qplot(miceTable$delta_ct_cewe) + theme_bw()
qplot(miceTable$delta_ct_ilwe) + theme_bw()
marshallData <- function (data, response) {
dataForResponse <- data[complete.cases(data[[response]]),]
dataForResponse_F <- dataForResponse[dataForResponse$Sex == "female",]
dataForResponse_M <- dataForResponse[dataForResponse$Sex == "male",]
dataForResponse_F$Sex <- droplevels(dataForResponse_F$Sex)
dataForResponse_M$Sex <- droplevels(dataForResponse_M$Sex)
return(list(
all = dataForResponse,
female = dataForResponse_F,
male = dataForResponse_M
))
}
runAll <- function (data, response) {
print(paste0("Fit for the response: ", response))
defaultConfig <- list(optimizer = "optimx",
method = c("bobyqa", "L-BFGS-B"),
control = list(follow.on = TRUE))
paramBounds <- c(L1start = 0, L1LB = 0, L1UB = 20,
L2start = 0, L2LB = 0, L2UB = 20,
alphaStart = 0, alphaLB = -5, alphaUB = 5)
marshalledData <- marshallData(data, response)
print("Fitting for all")
FitAll <- run(
data = marshalledData$all,
response = response,
hybridIndex = HI,
paramBounds = paramBounds,
config = defaultConfig
)
print("Fitting for female")
FitFemale <- run(
data = marshalledData$female,
response = response,
hybridIndex = HI,
paramBounds = paramBounds,
config = defaultConfig
)
print("Fitting for male")
FitMale <- run(
data = marshalledData$male,
response = response,
hybridIndex = HI,
paramBounds = paramBounds,
config = defaultConfig
)
return(list(FitAll = FitAll, FitFemale = FitFemale, FitMale = FitMale))
}
analyse <- function(data, response) {
print(paste0("Analysing data for response: ", response))
FitForResponse <- runAll(data, response)
####### Is alpha significant for each hypothesis?
# H0: the expected load for the subspecies and between sexes is the same
print("Testing H0 no alpha vs alpha")
Gtest(model0 = FitForResponse$FitAll$fitBasicNoAlpha,
model1 = FitForResponse$FitAll$fitBasicAlpha)
H0 <- FitForResponse$FitAll$fitBasicAlpha
# H1: the mean load across sexes is the same, but can differ across subspecies
print("Testing H1 no alpha vs alpha")
Gtest(model0 = FitForResponse$FitAll$fitAdvancedNoAlpha,
model1 = FitForResponse$FitAll$fitAdvancedAlpha)
H1 <- FitForResponse$FitAll$fitAdvancedAlpha
# H2: the mean load across subspecies is the same, but can differ between the sexes
print("Testing H2 female no alpha vs alpha")
Gtest(model0 = FitForResponse$FitFemale$fitBasicNoAlpha,
model1 = FitForResponse$FitFemale$fitBasicAlpha)
print("Testing H2 male no alpha vs alpha")
Gtest(model0 = FitForResponse$FitMale$fitBasicNoAlpha,
model1 = FitForResponse$FitMale$fitBasicAlpha)
H2 <- list(female = FitForResponse$FitFemale$fitBasicAlpha,
male = FitForResponse$FitMale$fitBasicAlpha)
# H3: the mean load can differ both across subspecies and between sexes
print("Testing H3 female no alpha vs alpha")
Gtest(model0 = FitForResponse$FitFemale$fitAdvancedNoAlpha,
model1 = FitForResponse$FitFemale$fitAdvancedAlpha)
print("Testing H3 male no alpha vs alpha")
Gtest(model0 = FitForResponse$FitMale$fitAdvancedNoAlpha,
model1 = FitForResponse$FitMale$fitAdvancedAlpha)
H3 <- list(female = FitForResponse$FitFemale$fitAdvancedAlpha,
male = FitForResponse$FitMale$fitAdvancedAlpha)
####### Compare the hypotheses with G-tests
# H1 vs H0
print("Testing H1 vs H0")
Gtest(model0 = H0, model1 = H1)
# H2 vs H0
print("Testing H2 vs H0")
Gtest(model0 = H0, model1 = H2)
# H3 vs H1
print("Testing H3 vs H1")
Gtest(model0 = H1, model1 = H3)
# H3 vs H2
print("Testing H3 vs H2")
Gtest(model0 = H2, model1 = H3)
return(list(H0 = H0, H1 = H1, H2 = H2, H3 = H3))
}
fit <- analyse(miceTable, "delta_ct_cewe")
ggplot(data = miceTable, aes(x = HI, y = delta_ct_ilwe)) +
geom_point()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_ilwe)) +
geom_point() +
theme_bw()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_ilwe, col = Sex)) +
geom_point() +
theme_bw()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_ilwe, col = Sex)) +
scale_color_manual(values = c("red", "blue")) +
geom_point() +
theme_bw()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_ilwe, col = Sex)) +
scale_color_manual(values = c("red", "blue")) +
geom_point() +
geom_smooth() +
theme_bw()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_ilwe, col = Sex)) +
scale_color_manual(values = c("red", "blue")) +
geom_smooth() +
geom_point() +
theme_bw()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_cewe, col = Sex)) +
scale_color_manual(values = c("red", "blue")) +
geom_smooth() +
geom_point() +
theme_bw()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_ilwe, col = Sex)) +
scale_color_manual(values = c("red", "blue")) +
geom_smooth() +
geom_point() +
theme_bw()
ggplot(data = miceTable, aes(x = HI, y = delta_ct_cewe, col = Sex)) +
scale_color_manual(values = c("red", "blue")) +
geom_smooth() +
geom_point() +
theme_bw()
data <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
View(data)
data <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
mousedata <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
mousdata$location
mousedata$location
c(mousedata$Longitude, mousedata$Latitude)
mousedata$location <- c(mousedata$Longitude, mousedata$Latitude)
mousedata$location <- NA
mousedata$location <- c(mousedata$Longitude, mousedata$Latitude)
mousedata$location <- paste(mousedata$Longitude, mousedata$Latitude)
View(mousedata)
mousedata$location
unique(mousedata$location)
mousedata$location
unique(mousedata$location)
unique(mousedata$location)
uniqueLoc <- unique(mousedata$location)
unique(mousedata[mousedata$location,])
subset(mousedata, !duplicated(mousedata$Mouse_ID))
subset(mousedata, unique(mousedata$Mouse_ID))
!duplicated(mousedata$location)
subset(mousedata, !duplicated(mousedata$location))
subdata <- subset(mousedata, !duplicated(mousedata$location))
mousedata$location <- paste(round(mousedata$Longitude,2), round(mousedata$Latitude, 3))
mousedata$location <- paste(round(mousedata$Longitude,2), round(mousedata$Latitude, 2))
subdata <- subset(mousedata, !duplicated(mousedata$location))
mousedata$location <- paste(round(mousedata$Longitude,3), round(mousedata$Latitude, 3))
subdata <- subset(mousedata, !duplicated(mousedata$location))
mousedata$location <- paste(round(mousedata$Longitude,4), round(mousedata$Latitude, 4))
subdata <- subset(mousedata, !duplicated(mousedata$location))
mousedata$location <- paste(round(mousedata$Longitude,2), round(mousedata$Latitude, 2))
subdata <- subset(mousedata, !duplicated(mousedata$location))
View(subdata)
mousedata$location <- paste(round(mousedata$Longitude,3), round(mousedata$Latitude, 3))
subdata <- subset(mousedata, !duplicated(mousedata$location))
mousedata$location <- paste(round(mousedata$Longitude,4), round(mousedata$Latitude, 4))
subdata <- subset(mousedata, !duplicated(mousedata$location))
mousedata$location <- paste(round(mousedata$Longitude,4), round(mousedata$Latitude, 4))
subdata <- subset(mousedata, !duplicated(mousedata$location))
View(subdata)
mousedata$location <- paste(round(mousedata$Longitude,3), round(mousedata$Latitude, 3))
subdata <- subset(mousedata, !duplicated(mousedata$location))
View(subdata)
View(mousedata)
View(data)
mousedata <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
mousedata$Sex
mouse2016 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ16_Mice_18-07-16_dissections.csv")
mouse2016$Sex
grep("young", mouse2016$Sex)
!grep("young", mouse2016$Sex)
grep("young", mouse2016$Sex)
mouse2016[-grep("young", mouse2016$Sex),]
mousedata2016 <- mouse2016[-grep("young", mouse2016$Sex),]
mouse2016 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ16_Mice_18-07-16_dissections.csv")
mousedata2016 <- mouse2016[-grep("young", mouse2016$Sex),]
mouse2016 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ16_Mice_18-07-16_dissections.csv")
mouse2016 <- mouse2016[-grep("young", mouse2016$Sex),]
mouse2016 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ16_Mice_18-07-16_dissections.csv")
mouse2016 <- mouse2016[-grep("young", mouse2016$Sex),]
mouse2016$location <- paste(round(mouse2016$Longitude,4), round(mouse2016$Latitude, 4))
View(mouse2016)
mouse2016ID <- mouse2016[-grep("young", mouse2016$Sex),"Mouse_ID"]
View(mouse2016)
mouse2016ID <- mouse2016[-grep("young", mouse2016$Sex),"ID_Mouse"]
mouse2016ID <- mouse2016[-grep("young", mouse2016$Sex),"ID_mouse"]
alldata <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
mouse2017 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ17_September_Mice_Dissection.csv")
alldata <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
mouse2017$Sex
View(mouse2017)
mouse2017$Status
grep("young", mouse2017$Status)
mouse2017ID <- mouse2017[-grep("young", mouse2017$Status), "Mouse_ID"]
IDs <- c(mouse2016ID, mouse2017ID)
alldata$Mouse_ID %in% IDs
mouse2016ID <- mouse2016[-grep("young", mouse2016$Sex),"ID_mouse"]
mouse2017ID <- mouse2017[-grep("young", mouse2017$Status), "Mouse_ID"]
mouse2016ID
mouse2016 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ16_Mice_18-07-16_dissections.csv")
mouse2017 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ17_September_Mice_Dissection.csv")
alldata <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
mouse2016ID <- mouse2016[-grep("young", mouse2016$Sex),"ID_mouse"]
mouse2017ID <- mouse2017[-grep("young", mouse2017$Status), "Mouse_ID"]
mouse2016ID
c(mouse2016ID, mouse2017ID)
c(as.character(mouse2016ID), as.character(mouse2017ID))
IDs <- c(as.character(mouse2016ID), as.character(mouse2017ID))
alldata$Mouse_ID %in% IDs
alldata[alldata$Mouse_ID %in% IDs,]
subdata <- alldata[alldata$Mouse_ID %in% IDs,]
paste(round(subdata$Longitude,4), round(subdata$Latitude, 4))
subdata$location <- paste(round(subdata$Longitude,4), round(subdata$Latitude, 4))
subsubdata <- subset(subdata, !duplicated(subsubdata$location))
subsubdata <- subset(subdata, !duplicated(subdata$location))
subdata$Sex
subF <- subdata[subdata$Sex == "F"]
subF <- subdata[subdata$Sex == "F",]
subM <- subdata[subdata$Sex == "M",]
subF <- subset(subF, !duplicated(subF$location))
subM <- subset(subM, !duplicated(subM$location))
rbind(subF, subM)
mydata <- rbind(subF, subM)
View(mydata)
pickMice <- function(IDs, data) {
# round loc
subdata <- alldata[alldata$Mouse_ID %in% IDs,]
subdata$location <- paste(round(subdata$Longitude,4), round(subdata$Latitude, 4))
# take 1 male, 1 female per location only
subF <- subdata[subdata$Sex == "F",]
subM <- subdata[subdata$Sex == "M",]
subF <- subset(subF, !duplicated(subF$location))
subM <- subset(subM, !duplicated(subM$location))
return(rbind(subF, subM))
}
pickMice <- function(IDs, alldata) {
# round loc
subdata <- alldata[alldata$Mouse_ID %in% IDs,]
subdata$location <- paste(round(subdata$Longitude,4), round(subdata$Latitude, 4))
# take 1 male, 1 female per location only
subF <- subdata[subdata$Sex == "F",]
subM <- subdata[subdata$Sex == "M",]
subF <- subset(subF, !duplicated(subF$location))
subM <- subset(subM, !duplicated(subM$location))
return(rbind(subF, subM))
}
pickMice(mouse2016ID, alldata)
micePicked2016 <- pickMice(mouse2016ID, alldata)
micePicked2017 <- pickMice(mouse2017ID, alldata)
myData <- rbind(micePicked2016, micePicked2017)
mouse2016 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ16_Mice_18-07-16_dissections.csv")
mouse2017 <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ17_September_Mice_Dissection.csv")
alldata <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/MiceTable_2014to2017.csv")
mouse2016ID <- mouse2016[-grep("young", mouse2016$Sex),"ID_mouse"]
mouse2017ID <- mouse2017[-grep("young", mouse2017$Status), "Mouse_ID"]
pickMice <- function(IDs, alldata) {
# round loc
subdata <- alldata[alldata$Mouse_ID %in% IDs,]
subdata$location <- paste(round(subdata$Longitude,4), round(subdata$Latitude, 4))
# take 1 male, 1 female per location only
subF <- subdata[subdata$Sex == "F",]
subM <- subdata[subdata$Sex == "M",]
subF <- subset(subF, !duplicated(subF$location))
subM <- subset(subM, !duplicated(subM$location))
return(rbind(subF, subM))
}
micePicked2016 <- pickMice(mouse2016ID, alldata)
micePicked2017 <- pickMice(mouse2017ID, alldata)
myData <- rbind(micePicked2016, micePicked2017)
dataCount <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
dataFeces <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ17_September_Mice_Dissection.csv")
dataCount <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
dataFeces <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ17_September_Mice_Dissection.csv")
View(dataFeces)
merge(dataCount, dataFeces)
merge(dataCount, dataFeces, by = Mouse_ID)
merge(dataCount, dataFeces, by = "Mouse_ID")
data <- merge(dataCount, dataFeces, by = "Mouse_ID")
View(data)
data$Feces_g <- data$Feces_weight
View(data)
data[names(data)%in% names(dataCount)]
dataCount <- data[names(data)%in% names(dataCount)]
View(dataCount)
dataCount$Feces_g
is.na(dataCount$Feces_g)
data[is.na(dataCount$Feces_g),]
data$Feces_g[data$Mouse_ID == "AA_0237"]
data$Feces_g[data$Mouse_ID == "AA_0237"] <- 0.34
data$Feces_g[data$Mouse_ID == "AA_0238"] <- 0.11
data$Feces_g[data$Mouse_ID == "AA_0239"] <- 0.36
data$Feces_g[data$Mouse_ID == "AA_0240"] <- 0.71
data$Feces_g[data$Mouse_ID == "AA_0240"] <- 0.71
data[is.na(dataCount$Feces_g),]
data[is.na(data$Feces_g),]
data$Feces_g[data$Mouse_ID == "AA_0240"] <- 0.71
as.character(data$Feces_g)
dataCount <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
dataFeces <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/HZ17_September_Mice_Dissection.csv")
data <- merge(dataCount, dataFeces, by = "Mouse_ID")
data$Feces_g <- data$Feces_weight
dataCount <- data[names(data)%in% names(dataCount)]
dataCount[is.na(dataCount$Feces_g),]
dataCount$Feces_g[dataCount$Mouse_ID == "AA_0237"] <- 0.34
dataCount$Feces_g[dataCount$Mouse_ID == "AA_0238"] <- 0.11
dataCount$Feces_g[dataCount$Mouse_ID == "AA_0239"] <- 0.36
dataCount$Feces_g[dataCount$Mouse_ID == "AA_0240"] <- 0.71
data$Feces_g <- as.character(data$Feces_g)
dataCount$Feces_g <- as.character(dataCount$Feces_g)
dataCount$Feces_g[dataCount$Mouse_ID == "AA_0240"] <- 0.71
dataCount[is.na(dataCount$Feces_g),]
dataCount$Feces_g
grep("2 mice same ca", dataCount$Feces_g)
dataCount[grep("2 mice same ca", dataCount$Feces_g),]
dataCount$Feces_g[grep("2 mice same ca", dataCount$Feces_g)]
dataCount$Feces_g[grep("2 mice same ca", dataCount$Feces_g)] <- NA
dataCount$Feces_g
as.numeric(dataCount$Feces_g)
dataCount$Feces_g <- as.numeric(dataCount$Feces_g)
View(dataCount)
dataCount$Feces_g == 444
dataCount[dataCount$Feces_g == 444,]
dataCount[dataCount$Feces_g %in% 444,]
dataCount$Feces_g[dataCount$Feces_g %in% 444]
dataCount$Feces_g[dataCount$Feces_g %in% 444] <- 0.44
dataCount$Feces_g[dataCount$Feces_g %in% 323] <- 0.32
dataCount$Feces_g[dataCount$Feces_g %in% 155] <- 0.16
dataCount$Feces_g[dataCount$Feces_g %in% 204] <- 0.20
View(dataCount)
data$mean_neubauer
dataCount$mean_neubauer
sum(dataCount[6:13])
rowSums(dataCount[6:13])
rowSums(dataCount[6:13]) / 8
dataCount$mean_neubauer <- rowSums(dataCount[6:13]) / 8
View(dataCount)
dataCount$oocysts_per_microL
dataCount$oocysts_per_microL <- dataCount$mean_neubauer * 10
dataCount$oocysts_per_microL * dataCount$PBS_dil_in_microL
dataCount$oocysts_per_microL * dataCount$PBS_dil_in_microL / dataCount$Feces_g
round(dataCount$oocysts_per_microL * dataCount$PBS_dil_in_microL / dataCount$Feces_g)
dataCount$OPG <- round(dataCount$oocysts_per_microL * dataCount$PBS_dil_in_microL / dataCount$Feces_g)
dataCountALL <- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
dataCountALL$Mouse_ID %in% dataCount$Mouse_ID
!dataCountALL$Mouse_ID %in% dataCount$Mouse_ID
dataCountALL[!dataCountALL$Mouse_ID %in% dataCount$Mouse_ID,]
A <- dataCountALL[!dataCountALL$Mouse_ID %in% dataCount$Mouse_ID,]
rbind(A, dataCount)
B <- rbind(A, dataCount)
View(B)
write.csv(x = B, file = "Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
write.csv(x = B, file = "Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv", row.names = F)
mouse2017 <- read.csv("../raw_data/HZ17_September_Mice_Dissection.csv")
alldata <- read.csv("../raw_data/MiceTable_2014to2017.csv")
mouse2015 <- alldata[alldata$Year == 2015,]
data<- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
View(data)
data<- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
data<- read.csv("Schreibtisch/git_projects/Mouse_Eimeria_Databasing/raw_data/Eimeria_detection/Alice_newdilution_oocysts_counts_jan2018.csv")
View(data)
mean(data[6:13])
mean(data[c(6:13)])
data[c(6:13)]
lapply(data[c(6:13)], mean)
sapply(data[c(6:13)], mean)
apply(data[c(6:13)], mean)
mytab <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/1_informationTables/April2018_wildmice_Eferrisi_INFO.csv")
duplicated(mytab$original_mouse_id)
table(mytab$sex)
table(mytab$Mouse_strain)
table(mytab$sex, mytab$Mouse_strain)
birthdays <- as.Date(mytab$born)
birthdays <- format(birthdays, format = "%d-%m-%Y")
birthdays <- sub("18-", replacement = "2018-", birthdays)
birthdays <- sub("17-", replacement = "2017-", birthdays)
infectionDate <- "2018-05-02"
age <- difftime(infectionDate, birthdays, units = "days")
age <- as.numeric(age)
age <- age/7
hist(age, breaks = 50)
age <- difftime(infectionDate, birthdays, units = "weeks")
age <- as.numeric(age)
age <- age/7
age <- difftime(infectionDate, birthdays, units = "weeks")
age <- as.numeric(age)
hist(age, breaks = 50)
mytab$ageAtInfection <- age
table(mytab$ageAtInfection >= 12)
G1Tab <- mytab[mytab$ageAtInfection >= 12,]
table(G1Tab$sex, G1Tab$Mouse_strain)
library(ggrepel)
ggplot(mytab, aes(x = Mouse_strain, y = ageAtInfection, col = sex,
label = original_mouse_id)) +
geom_boxplot() +
geom_label_repel() +
theme_bw()
table(G1Tab$sex, G1Tab$ageAtInfection)
sort(G1Tab$ageAtInfection)
tail(sort(G1Tab$ageAtInfection), 6)
tail(sort(G1Tab$ageAtInfection[G1Tab$Mouse_strain %in% "STRA"]), 6)
x <- tail(sort(G1Tab$ageAtInfection[G1Tab$Mouse_strain %in% "STRA"]), 6)
G1Tab[G1Tab$ageAtInfection %in% x & G1Tab$Mouse_strain %in% "STRA"]
G1Tab[G1Tab$ageAtInfection %in% x & G1Tab$Mouse_strain %in% "STRA",]
G1Tab[G1Tab$ageAtInfection %in% x & G1Tab$Mouse_strain %in% "STRA",]
G1Tab$original_mouse_id[G1Tab$ageAtInfection %in% x & G1Tab$Mouse_strain %in% "STRA"]
G1Tab$original_mouse_id[G1Tab$ageAtInfection %in% x & G1Tab$Mouse_strain %in% "STRA"]
keepStra <- G1Tab$original_mouse_id[G1Tab$ageAtInfection %in% x & G1Tab$Mouse_strain %in% "STRA"]
G1Tab$original_mouse_id %in% keepStra | G1Tab$Mouse_strain != "STRA"
G1Tab[G1Tab$original_mouse_id %in% keepStra | G1Tab$Mouse_strain != "STRA",]
G1Tab[G1Tab$original_mouse_id %in% keepStra | !G1Tab$Mouse_strain %in%  "STRA",]
G1Tab[G1Tab$original_mouse_id %in% keepStra,]
G1Tab$Mouse_strain %in% "STRA"
!G1Tab$Mouse_strain %in% "STRA"
G1Tab[!G1Tab$Mouse_strain %in% "STRA",]
!G1Tab$Mouse_strain %in% "STRA"
G1Tab[!G1Tab$Mouse_strain %in% "STRA",]
G1Tab[G1Tab$original_mouse_id %in% keepStra | !G1Tab$Mouse_strain %in% "STRA",]
G1Tab <- G1Tab[G1Tab$original_mouse_id %in% keepStra | !G1Tab$Mouse_strain %in% "STRA",]
table(G1Tab$sex, G1Tab$Mouse_strain)
library(ggplot2)
mytab <- read.csv("https://raw.githubusercontent.com/derele/Eimeria_Lab/master/data/1_informationTables/April2018_wildmice_Eferrisi_INFO.csv")
duplicated(mytab$original_mouse_id)
table(mytab$sex)
table(mytab$Mouse_strain)
table(mytab$sex, mytab$Mouse_strain)
birthdays <- as.Date(mytab$born)
birthdays <- format(birthdays, format = "%d-%m-%Y")
birthdays <- sub("18-", replacement = "2018-", birthdays)
birthdays <- sub("17-", replacement = "2017-", birthdays)
infectionDate <- "2018-05-02"
age <- difftime(infectionDate, birthdays, units = "weeks")
age <- as.numeric(age)
hist(age, breaks = 50)
mytab$ageAtInfection <- age
table(mytab$ageAtInfection >= 12)
G1Tab <- mytab[mytab$ageAtInfection >= 12,]
table(G1Tab$sex, G1Tab$Mouse_strain)
x <- tail(sort(G1Tab$ageAtInfection[G1Tab$Mouse_strain %in% "STRA"]), 6)
keepStra <- G1Tab$original_mouse_id[G1Tab$ageAtInfection %in% x & G1Tab$Mouse_strain %in% "STRA"]
G1Tab <- G1Tab[G1Tab$original_mouse_id %in% keepStra | !G1Tab$Mouse_strain %in% "STRA",]
table(G1Tab$sex, G1Tab$Mouse_strain)
library(ggplot2)
library(ggrepel)
ggplot(mytab, aes(x = Mouse_strain, y = ageAtInfection, col = sex,
label = original_mouse_id)) +
geom_boxplot() +
geom_label_repel() +
theme_bw()
ggplot(mytab, aes(x = Mouse_strain, y = ageAtInfection, col = sex,
label = original_mouse_id)) +
geom_boxplot() +
geom_point() +
theme_bw()
ggplot(mytab, aes(x = Mouse_strain, y = ageAtInfection, col = sex,
label = original_mouse_id)) +
geom_boxplot() +
geom_label_repel() +
theme_bw()
ggplot(G1Tab, aes(x = Mouse_strain, y = ageAtInfection, col = sex,
label = original_mouse_id)) +
geom_boxplot() +
geom_label_repel() +
theme_bw()
G1Tab$original_mouse_id
G1Tab
write.csv(G1Tab, file = "../alice/Schreibtisch/git_projects/Eimeria_Lab/data/1_informationTables/April2018_wildmice_Eferrisi_Firstbatch_INFO", row.names = F)
mydata <- read.csv("./Schreibtisch/git_projects/Eimeria_Lab/data/2_designTables/April2018_wildmice_Eferrisi_Firstbatch_DESIGN.csv")
table(mydata$sex, mydata$Eimeria_isolate)
table(mydata$sex, mydata$Eimeria_isolate, mydata$Mouse_strain)
table(mydata$sex, mydata$Mouse_strain, mydata$Eimeria_isolate)
order(mydata$EH_id)
mydata$EH_id
source("HMHZ_Functions.R")
source("HMHZ_Functions.R")
Vivian <- read.csv("../raw_data/MiceTable_2014to2017.csv")
Vivian <- Vivian[Vivian$Mouse_ID %in% c("AA_0139", "AA_0064"),]
HI.map(df = Vivian, margin = 1, zoom = 8, alpha = 1)
source("HMHZ_Functions.R")
source("/home/alice/Schreibtisch/git_projects/Mouse_Eimeria_Databasing/R/HMHZ_Functions.R")
Vivian <- read.csv("../raw_data/MiceTable_2014to2017.csv")
setwd("/home/alice/Schreibtisch/git_projects/Mouse_Eimeria_Databasing/")
setwd("/home/alice/Schreibtisch/git_projects/Mouse_Eimeria_Databasing/R")
source("HMHZ_Functions.R")
Vivian <- read.csv("../raw_data/MiceTable_2014to2017.csv")
Vivian <- Vivian[Vivian$Mouse_ID %in% c("AA_0139", "AA_0064"),]
HI.map(df = Vivian, margin = 1, zoom = 8, alpha = 1)
